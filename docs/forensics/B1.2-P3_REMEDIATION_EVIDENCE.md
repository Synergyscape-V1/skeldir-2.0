# B1.2-P3 Remediation Evidence

## 1) Initial Findings (Scientific Baseline)
- Target branch and commit under validation:
  - `main` at `c13b1e74a90fd025c797f9c8c14050c56fb222d2` (merge commit for PR #148).
- Baseline method:
  - Read branch protection required contexts from GitHub API.
  - Resolve each required context against check-runs/status contexts for the exact SHA.
  - Recompute pass/fail matrix until terminal.
- Baseline result:
  - 14/15 required contexts were green.
  - `Phase 8 Regression Gate (Full Physics)` remained missing on the merge SHA, so `main` was not scientifically validated green.
  - Root cause: `.github/workflows/b07-phase8-full-physics-staging.yml` does not trigger on `push` to `main`; it triggers on `pull_request`, `merge_group`, and `workflow_dispatch`.

## 2) Remediations Implemented
- P3 functional remediations (merged via PR #148):
  - RS256-only verifier contract enforced.
  - Verifier/signer key-source split (public key ring for verification, private secret for signing).
  - Bounded unknown-`kid` refresh with debounce semantics.
  - Non-vacuous negative controls for per-request refresh regression.
- CI execution remediation to close required-check gap on `main`:
  - Dispatched `b07-phase8-full-physics-staging.yml` on `main` for SHA `c13b1e74...`.
  - Used `runner_label=ubuntu-latest` to avoid queue starvation on `ubuntu-8core`.
  - Dispatch run: https://github.com/Synergyscape-V1/skeldir-2.0/actions/runs/22550185316

## 3) End-to-End Required-Check Validation on Main
- Validation timestamp (local): `2026-03-01T13:05:53-06:00`
- Target SHA: `c13b1e74a90fd025c797f9c8c14050c56fb222d2`
- Required contexts from branch protection: `15`
- Result: `15/15 success` (scientifically validated green for all required merge-blocking checks on `main`).
- Artifacts:
  - `docs/forensics/evidence/b12_p3/main_required_checks_validation.json`
  - `docs/forensics/evidence/b12_p3/required_checks_matrix_main.tsv`

## 4) Exit Gate Mapping
### Exit Gate 1 - Cryptographic Contract Lock (RS256-only)
- Proof tests:
  - `backend/tests/test_b12_p3_jwt_verification_standardization.py::test_rs256_token_is_accepted`
  - `backend/tests/test_b12_p3_jwt_verification_standardization.py::test_hs256_token_is_rejected`
  - `backend/tests/test_b12_p3_jwt_verification_standardization.py::test_alg_none_token_is_rejected`
- Required-check evidence:
  - `Phase 1 Negative Controls` -> success
  - `JWT Tenant Context Invariants` -> success

### Exit Gate 2 - Hot-Path External Fetch Elimination
- Proof tests:
  - `backend/tests/test_b12_p3_jwt_verification_standardization.py::test_verification_steady_state_does_not_read_secret_source`
  - `backend/tests/test_b12_p3_jwt_verification_standardization.py::test_http_plane_steady_state_does_not_read_secret_source`
  - `backend/tests/test_b12_p3_jwt_verification_standardization.py::test_worker_plane_uses_same_verifier_and_no_fetch`
- Negative-control enforcement:
  - Forced refresh regression toggle is exercised by negative-control harness in CI.

### Exit Gate 3 - Bounded Refresh + Unknown-kid Debounce
- Proof tests:
  - `backend/tests/test_b11_p3_jwt_rotation_semantics.py::test_unknown_kid_forces_debounced_refresh_and_recovers`
  - `backend/tests/test_b11_p3_jwt_rotation_semantics.py::test_unknown_kid_refresh_is_debounced_under_flood`
  - `backend/tests/test_b11_p3_jwt_rotation_semantics.py::test_unknown_kid_refresh_failure_degrades_to_bounded_fallback`
- Required-check evidence:
  - `JWT Tenant Context Invariants` -> success

### Exit Gate 4 - Cross-plane Parity
- Shared verifier primitive:
  - `app.tasks.context.decode_worker_auth_token -> app.security.auth.decode_and_verify_jwt`
- Proof:
  - `backend/tests/test_b12_p3_jwt_verification_standardization.py::test_worker_plane_uses_same_verifier_and_no_fetch`

### Exit Gate 5 - CI Enforcement Plane Compliance
- Required-check source:
  - GitHub branch protection contexts for `main` (queried live).
- Empirical proof:
  - `docs/forensics/evidence/b12_p3/required_checks_matrix_main.tsv` shows every required context in `success`.
  - Includes `Phase 8 Regression Gate (Full Physics)` from run `22550185316`.
