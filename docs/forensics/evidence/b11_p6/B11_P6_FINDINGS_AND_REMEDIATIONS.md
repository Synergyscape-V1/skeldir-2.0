# B11_P6 Findings And Remediations

Date: 2026-02-24
Phase: B1.1-P6 End-to-End Integration Testing & Operational Readiness Closure Pack
Branch: b11-p6-corrective-action
Target: main

## Hypothesis Adjudication (H01-H06)

| Hypothesis | Status | Evidence |
|---|---|---|
| H01 - No durable evidence index exists on main | TRUE | `docs/forensics/evidence/b11_p6/` on `main` only contained `README.md` before this corrective; no committed `PROOF_INDEX.md`/`MANIFEST.json` generated by authoritative run. |
| H02 - Checksum system is self-referential/ephemeral | TRUE | Run `22361591134` produced artifact `5639280971` with digest `56a38f02...` but digest existed only in GitHub artifact metadata/logs; no durable pointer+digest chain committed. |
| H03 - No immutable commit->run->artifact->digest mapping | TRUE | Previous workflow generated `PROOF_INDEX.md` only inside uploaded artifact, not persisted on `main`; mapping decayed with artifact retention. |
| H04 - Stage CloudTrail tether not run-causal | TRUE | Prior P6 used broad CloudTrail lookup from P4 script with long lookback and no CI-run trigger marker. |
| H05 - Release/tag publication requires overbroad permissions | TRUE | Workflow token permissions were `Contents: read` (run log `22361591134`); release publication requires write-level content scope and is excluded by least-privilege policy. |
| H06 - Report meta-claims inaccurate | TRUE | Prior narrative claim set overstated CI check structure; corrected here by anchoring to actual run IDs/artifact IDs only. |

## Root Cause Confirmation

- RC1 confirmed: evidence relied on `actions/upload-artifact` retention only.
- RC2 confirmed: no repo-anchored durability artifacts existed.
- RC3 confirmed: no explicit CI stage trigger in P6.
- RC4 confirmed: release publication path conflicts with least-privilege workflow token model.
- RC5 confirmed: no canonical subset digest separated stable vs volatile telemetry.

## Remediations Implemented

1. Durable publication path added to P6 workflow:
- S3 publication via OIDC (`aws s3api put-object`) with AES256 SSE.
- Repo-anchored outputs generated on main run:
  - `docs/forensics/evidence/b11_p6/PROOF_INDEX.md`
  - `docs/forensics/evidence/b11_p6/MANIFEST.json`
  - `docs/forensics/evidence/b11_p6/sha256SUMS.txt`
  - `docs/forensics/evidence/b11_p6/evidence_bundle_pointer.txt`

2. Canonical manifest determinism implemented:
- `scripts/security/b11_p6_finalize_evidence.py` creates two-layer evidence structure.
- `manifest_digest` computed from canonical subset (stable deterministic artifacts only).
- Telemetry artifacts validated for required schema/markers, not bitwise equality.

3. Run-causal stage tether implemented:
- `scripts/security/b11_p6_stage_run_causal_tether.py` performs CI-driven stage runtime role assume + stage secret read with run marker (`P6_RUN_ID`).
- Windowed CloudTrail query confirms stage role `skeldir-app-runtime-stage` after trigger start.
- Writes `docs/forensics/evidence/b11_p6/cloudtrail_stage_run_causal.txt`.

4. CI audited retrieval hardened for P6:
- `scripts/security/b11_p6_ci_audit_retrieval.py` captures OIDC identity + CI secret reads + CI role CloudTrail tether in tight window.

5. Independent verifier added:
- `scripts/security/verify_b11_p6_evidence.py` fetches bundle from durable pointer, verifies zip SHA256, validates per-file hashes, and re-computes manifest digest.

6. Workflow contract corrected:
- `.github/workflows/b11-p6-end-to-end-closure-pack.yml` now orchestrates durability, stage causality, manifest generation, and verification without widening GitHub `contents` permissions.

## Exit Gate Mapping (Corrective Design)

- Exit Gate A: repo-anchored `PROOF_INDEX`/`MANIFEST`/pointer/sha256 created on main.
- Exit Gate B: verifier script validates bundle integrity end-to-end.
- Exit Gate C: canonical `manifest_digest` generated from stable subset.
- Exit Gate D: stage run-causal CloudTrail proof artifact generated from CI-triggered stage read.
- Exit Gate E: closure substantive gates retained and executed in same workflow.
- Exit Gate F: this report corrected to factual run IDs/artifact IDs and durable pointer contract.

## Authoritative Run Anchor (to be filled by main run)

- commit_sha: pending
- run_id: pending
- run_url: pending
- evidence_bundle_uri: pending
- evidence_bundle_sha256: pending
- manifest_digest: pending

This section is populated by the first successful `main` run after merging this corrective.
